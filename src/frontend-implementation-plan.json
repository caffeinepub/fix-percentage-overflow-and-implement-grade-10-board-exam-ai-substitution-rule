{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Add average percentage to subject analysis and fix mathematics elective status for commerce",
  "requirements": [
    {
      "id": "REQ-1",
      "summary": "Display average percentage alongside average raw marks in the Subject Analysis view for each subject, calculated using the subject-specific max marks",
      "acceptanceCriteria": [
        "Subject Analysis table shows both average raw marks and average percentage for each subject",
        "Percentage is calculated correctly using grade-appropriate max marks",
        "Format maintains existing table layout and readability"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/SubjectAnalysisView.tsx",
          "operation": "modify",
          "description": "Add average percentage column to the Subject Analysis table. Update the table headers to include 'Avg %' alongside 'Average Marks'. Use the existing calculatePercentage utility from frontend/src/lib/percent.ts to compute percentages based on average marks and grade-appropriate max marks from frontend/src/lib/maxMarks.ts. Ensure the percentage is formatted consistently (e.g., one decimal place) and displayed in the same table structure. Update the bar chart data to optionally show percentage values if needed for visualization."
        }
      ]
    },
    {
      "id": "REQ-2",
      "summary": "Change Mathematics from compulsory to elective subject for Commerce subgroup (CEBA and CEBA-CS streams) in the marks entry form",
      "acceptanceCriteria": [
        "Mathematics appears in the elective subjects section for Commerce subgroups (CEBA, CEBA-CS)",
        "Mathematics is not shown in the compulsory subjects section for Commerce subgroups",
        "Other subgroups (Science, Humanities) remain unaffected",
        "Subject configuration logic correctly handles Mathematics as elective for Commerce streams"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/AddMarksForm.tsx",
          "operation": "modify",
          "description": "Update the subject configuration logic to move Mathematics from compulsory to elective for Commerce subgroups (CEBA and CEBA-CS). Modify the conditional logic that determines which subjects are compulsory vs elective based on the selected subgroup. For Commerce streams (CEBA, CEBA-CS), ensure Mathematics is included in the elective subjects array instead of the compulsory subjects array. Verify that Science and Humanities subgroups continue to treat Mathematics as compulsory. Ensure the dynamic subject rendering correctly reflects this change in both the compulsory and elective sections of the form."
        }
      ]
    }
  ]
}